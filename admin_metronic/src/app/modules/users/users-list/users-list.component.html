<div class="card card-custom gutter-b">
  <div class="card-header">
    <div class="card-title">
      <h3 class="card-label">
        <i class="icon-2x text-dark-50 flaticon-users mx-2"></i> Lista Usuarios
      </h3>
    </div>
    <div class="card-toolbar">
      <a type="button" (click)="openCreate()" class="btn btn-primary">
        <i class="icon-2x text-white flaticon-user-add"></i> Nuevo Usuario
      </a>
    </div>
  </div>
  <div class="card-body">
    <!-- begin: Carga -->
    <ng-container *ngIf="isLoading$ | async; else mostrarTabla">
      <div class="text-center py-10">
        <div class="spinner-border text-primary" role="status"></div>
        <p class="mt-3">Cargando usuarios...</p>
      </div>
    </ng-container>

    <!-- begin: Tabla de usuarios -->
    <ng-template #mostrarTabla>
      <div class="form form-label-right"></div>

      <div class="row">
        <div class="col-12">
          <div class="table-responsive">
            <table
              class="table table-head-custom table-vertical-center"
              id="kt_advance_table_widget_1"
            >
              <thead>
                <tr class="text-left">
                  <th>Nombres</th>
                  <th>Apellidos</th>
                  <th>Email</th>
                  <th>Rol</th>
                  <th>Acción</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let user of users">
                  <td>{{ user.name }}</td>
                  <td>{{ user.lastname || '—' }}</td>
                  <td>{{ user.email }}</td>
                  <td>{{ user.rol }}</td>
                  <td>
                    <a
                      (click)="editUser(user)"
                      class="btn btn-icon btn-light btn-hover-primary btn-sm mx-1"
                      ngbTooltip="Editar Usuario"
                      ngbTooltipClass="kt-tooltip"
                    >
                      <span class="svg-icon svg-icon-md svg-icon-primary">
                        <!-- Icono editar -->
                        <svg
                          xmlns="http://www.w3.org/2000/svg"
                          width="24px"
                          height="24px"
                          viewBox="0 0 24 24"
                        >
                          <g fill="none" fill-rule="evenodd">
                            <rect width="24" height="24" />
                            <path
                              d="M12.3 18.2L12 5.5c-.01-.4.15-.78.43-1.07l2.58-2.69 2.59 2.7c.27.28.42.65.42 1.04L18 18.2c0 .83-.67 1.5-1.5 1.5h-2.7c-.82 0-1.48-.66-1.5-1.48z"
                              fill="#000"
                            />
                            <path
                              d="M12.9 2c.55 0 1 .45 1 1s-.45 1-1 1H6c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2v-5c0-.55.45-1 1-1s1 .45 1 1v5c0 2.21-1.79 4-4 4H6c-2.21 0-4-1.79-4-4V6c0-2.21 1.79-4 4-4h6.9z"
                              fill="#000"
                              opacity=".3"
                            />
                          </g>
                        </svg>
                      </span>
                    </a>
                    <a
                      (click)="delete(user)"
                      class="btn btn-icon btn-light btn-hover-primary btn-sm"
                      ngbTooltip="Eliminar Usuario"
                      ngbTooltipClass="kt-tooltip"
                    >
                      <span class="svg-icon svg-icon-md svg-icon-danger">
                        <!-- Icono borrar -->
                        <svg
                          xmlns="http://www.w3.org/2000/svg"
                          width="24px"
                          height="24px"
                          viewBox="0 0 24 24"
                        >
                          <g fill="none" fill-rule="evenodd">
                            <rect width="24" height="24" />
                            <path
                              d="M6 8v12.5c0 .83.67 1.5 1.5 1.5h9c.83 0 1.5-.67 1.5-1.5V8H6z"
                              fill="#000"
                            />
                            <path
                              d="M14 4.5V4c0-.55-.45-1-1-1h-2c-.55 0-1 .45-1 1v.5H5.5c-.28 0-.5.22-.5.5v.5c0 .28.22.5.5.5H18.5c.28 0 .5-.22.5-.5v-.5c0-.28-.22-.5-.5-.5H14z"
                              fill="#000"
                              opacity=".3"
                            />
                          </g>
                        </svg>
                      </span>
                    </a>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </ng-template>
  </div>
</div>
